{% extends 'base.html' %}
{% load static %}


{% block style %}
<link rel="stylesheet" href="{% static 'posts/css/post.css' %}">
{% endblock style %}


{% block content %}
<main>
    <div class='container my-5'>
        <div class="d-flex mb-3">
            <div class="d-flex flex-grow-1 align-items-center gap-3">
                <div class="post--cate_form_icon d-flex justify-content-center align-items-center"><span class="material-symbols-outlined">stylus</span></div>
                <h2><strong>스터디 카페</strong></h2>
            </div>
            <a href="{% url 'posts:review_create' post.pk %}" class="post--create_btn d-flex align-items-center justify-content-center gap-3"><span class="material-symbols-outlined">edit_square</span><div>리뷰작성</div></a>
        </div>
        <!-- 지도 -->
        <div class="post--map_form mb-3"></div>
        <!-- 카페 기본정보 -->
        <div class="post--info_form">
            <!-- 주소 정보 -->
            <div class="d-flex mb-3">
                <div class="col-2 d-flex gap-2">
                    <span class="material-symbols-outlined">location_on</span>
                    <h5><strong>주소</strong></h5>
                </div>
                <div>서울 종로구 북촌로 6-3 1층</div>
            </div>

            <!-- 전화번호 -->
            <div class="d-flex mb-3">
                <div class="col-2 d-flex gap-2">
                    <span class="material-symbols-outlined">call</span>
                    <h5><strong>전화번호</strong></h5>
                </div>
                <div>0000-0000-0000</div>
            </div>

            <!-- 영업시간 -->
            <div class="d-flex mb-3">
                <div class="col-2 d-flex gap-2">
                    <span class="material-symbols-outlined">schedule</span>
                    <h5><strong>영업시간</strong></h5>
                </div>
                <div>00:00 - 00:00 | 정기휴무 : 매주 일요일</div>
            </div>

            <!-- 편의시설/정보 -->
            <div class="d-flex">
                <div class="col-2 d-flex gap-2">
                    <span class="material-symbols-outlined">info</span>
                    <h5><strong>편의시설 정보</strong></h5>
                </div>
                <div>주차가능</div>
            </div>
        </div>

        <hr>

        <!-- 리뷰 -->
        <h4 class="my-4"><strong>리뷰 ({{ posts|length }})</strong></h4>

        {% for review in reviews %}
        <div class="post--detail_form mb-3">
            <div class="d-flex gap-4">
                <!-- 리뷰 프로필 이미지 -->
                <div class="col-1 d-flex flex-column align-items-center gap-3">
                    {% if review.user.profile_image %}
                        <div class='profile--img_medium_form'>
                            <img src="{{ review.user.profile_image.url }}" alt="">
                        </div>
                    {% else %}
                        <div class='profile--img_medium_form'>
                            <img src="{% static 'accounts/img/no_profile.jpeg' %}" alt="profile_image">
                        </div>
                    {% endif %}
                    <a href='{% url 'accounts:profile' user.username %}'><strong>{{ review.user.username }}</strong></a>
                </div>
                <div class="col-10 d-flex flex-column">
                    <div class="mb-3">
                        {% if review.created_string == False %}
                            {{ review.created_at|date:'Y-m-d' }}
                        {% else %}
                            {{ review.created_string }}
                        {% endif %}
                    </div>
                    <a href="{% url 'posts:review_detail' post.pk review.pk %}">
                        <div><strong>{{ review.title }}</strong></div>
                        <div class="mb-4">{{ review.content }}</div>
                        <div class="d-flex gap-3">
                            {% for photo in photos %}
                                <div class="photo--form">
                                    <img src="{{ photo.photo.url }}" alt="photo">
                                </div>
                            {% endfor %}
                        </div>
                    </a>
                </div>
                <div class="col-1">
                    <div>
                        <form action="{% url 'posts:likes' post.pk %}" method="POST">
                        {% csrf_token %}
                        {% if request.user in post.like_users.all %}
                            <button type="submit" class="border-0 post--like_btn">
                            <span class="material-symbols-outlined">
                                favorite
                            </span>
                            </button>
                        {% else %}
                            <button type="submit" class="border-0 post--unlike_btn">
                            <span class="material-symbols-outlined">
                                favorite
                            </span>
                            </button>
                        {% endif %}
                        </form>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</main>
{% endblock content %}